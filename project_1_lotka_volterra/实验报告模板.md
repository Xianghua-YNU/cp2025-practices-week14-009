# 项目1实验报告：Lotka-Volterra捕食者-猎物模型

**学生姓名：** [余维]  
**学号：** [20231050005]  
**完成日期：** [2025/5/30]  
**实验时间：** [2025/5/28]

---

## 1. 实验目的

本实验旨在通过数值方法求解Lotka-Volterra捕食者-猎物模型，掌握以下内容：

- 理解生物种群动力学的数学建模方法
- 学习将高阶常微分方程组转换为一阶方程组的标准形式
- 掌握多种数值方法求解常微分方程组（欧拉法、改进欧拉法、4阶龙格-库塔法）
- 比较不同数值方法的精度和稳定性
- 分析生态系统中捕食者与猎物的相互作用规律

## 2. 理论背景

### 2.1 Lotka-Volterra方程组

请简要描述Lotka-Volterra方程组的数学形式和各参数的生物学意义：

```
[α：猎物的自然增长率，表示在没有捕食者时，猎物因繁殖和自然死亡平衡后的净增长率（例如，α=0.1表示猎物每年增长10%）。

β：捕食效率，反映单个捕食者对猎物的捕杀能力（例如，β=0.05表示每个捕食者每天捕食5%的猎物）。

γ：转化效率，表示捕食者将猎物种群转化为自身繁殖的效率（例如，γ=0.02表示捕食者每吃掉100个猎物，自身数量增长2%）。

δ：捕食者的自然死亡率，表示在没有猎物时，捕食者因饥饿或衰老导致的死亡率（例如，δ=0.3表示捕食者每年减少30%）。

]
```
![屏幕截图 2025-05-28 113557](https://github.com/user-attachments/assets/63a93f25-5552-477f-b9aa-c19ab729dc7e)


### 2.2 数值方法原理

请简要说明您实现的三种数值方法的基本原理：

**欧拉法：**
```
[基本公式：y_{n+1} = y_n + dt * f(y_n, t_n)

一阶精度，计算简单但精度有限]
```

**改进欧拉法：**
```
[改进之处：使用两个斜率的平均值

公式：
k1 = dt * f(y_n, t_n)
k2 = dt * f(y_n + k1, t_n + dt)
y_{n+1} = y_n + (k1 + k2)/2

二阶精度，比欧拉法更精确]
```

**4阶龙格-库塔法：**
```
[优势：使用四个斜率加权平均

公式：
k1 = dt * f(y_n, t_n)
k2 = dt * f(y_n + k1/2, t_n + dt/2)
k3 = dt * f(y_n + k2/2, t_n + dt/2)
k4 = dt * f(y_n + k3, t_n + dt)
y_{n+1} = y_n + (k1 + 2k2 + 2k3 + k4)/6

四阶精度，计算精度高但计算量较大]
```

## 3. 实验方法与实现

### 3.1 参数设置

根据题目要求，本实验使用以下参数：

- 模型参数：α = 1.0, β = 0.5, γ = 0.5, δ = 2.0
- 初始条件：x₀ = 2.0, y₀ = 2.0
- 时间范围：t ∈ [0, 30]
- 时间步长：dt = 0.01

### 3.2 核心算法实现

请在此处粘贴您实现的核心函数代码片段（选择最重要的1-2个函数）：

```python
# 例如：lotka_volterra_system函数
[def lotka_volterra_system(state, t, alpha, beta, gamma, delta):
    x, y = state
    dxdt = alpha * x - beta * x * y
    dydt = gamma * x * y - delta * y
    return np.array([dxdt, dydt])
]
```

```python
# 例如：runge_kutta_4函数
[def runge_kutta_4(f, y0, t_span, dt, *args):
    t_start, t_end = t_span
    t = np.arange(t_start, t_end + dt, dt)
    n_steps = len(t)
    n_vars = len(y0)
    y = np.zeros((n_steps, n_vars))
    y[0] = y0
    
    for i in range(n_steps - 1):
        h = dt
        yi = y[i]
        ti = t[i]
        k1 = h * f(yi, ti, *args)
        k2 = h * f(yi + k1/2, ti + h/2, *args)
        k3 = h * f(yi + k2/2, ti + h/2, *args)
        k4 = h * f(yi + k3, ti + h, *args)
        y[i+1] = yi + (k1 + 2*k2 + 2*k3 + k4)/6
    
    return t, y]
```

### 3.3 实现过程中遇到的问题

请描述您在实现过程中遇到的主要问题及解决方法：

```
[问题： 相空间轨迹图初始点标记位置错误
解决： 修改代码确保使用x[0]和y[0]标记起点

问题： 能量守恒量计算错误
解决： 修正守恒量公式为：
H = gamma*x + beta*y - delta*np.log(x) - alpha*np.log(y)

问题： 方法比较图中曲线重叠
解决： 使用不同颜色和线型区分各方法结果]
```

## 4. 实验结果

### 4.1 基本求解结果

请在此处粘贴使用4阶龙格-库塔法求解得到的种群动力学图：

```
![屏幕截图 2025-05-30 143311](https://github.com/user-attachments/assets/a33697c4-8184-40be-90df-ba216d319238)

[]
图4.1: Lotka-Volterra种群动力学
左图：种群数量随时间变化；右图：相空间轨迹
```

**观察结果描述：**
```
[左图（时间序列）： 猎物（蓝色）和捕食者（红色）数量呈现周期性振荡

右图（相空间）： 系统轨迹形成闭合环，表明周期性行为

观察： 猎物数量峰值领先捕食者约1/4周期，符合"猎物增加→捕食者增加→猎物减少→捕食者减少"的生态规律]
```

### 4.2 数值方法比较

请在此处粘贴三种数值方法的比较图：

```
[![屏幕截图 2025-05-30 143452](https://github.com/user-attachments/assets/cc2b202f-284b-41dd-8b31-ef81411e6149)
]
图4.2: 三种数值方法比较
上排：时间序列比较；下排：相空间比较
```

**比较结果分析：**

| 方法 | 计算精度 | 计算效率 | 稳定性 | 守恒量误差 |
|------|----------|----------|--------|------------|
| 欧拉法 | [低] | [高] | [差] | [大（>10%)] |
| 改进欧拉法 | [中] | [中] | [较好] | [中（~5%）] |
| 4阶RK法 | [高] | [低] | [优] | [小（<1%）] |

### 4.3 参数影响分析

请在此处粘贴不同初始条件下的结果图：

```
[![image](https://github.com/user-attachments/assets/e7782503-2474-4cae-8edf-dd1067c6adb3)

![屏幕截图 2025-05-30 143625](https://github.com/user-attachments/assets/689eb67d-1953-4c1f-a634-119856f65d27)

]
图4.3: 不同初始条件的影响
```

**参数敏感性分析：**
```
[初始条件影响：

初始值越大，振荡幅度越大

初始比例影响相空间轨迹大小

守恒量验证：

RK4方法保持H值恒定（波动<0.5%）

欧拉法H值漂移明显]
```

## 5. 结果分析与讨论

### 5.1 生物学意义分析

请从生物学角度分析实验结果：

**种群动力学特征：**
```
[振荡周期约10-12时间单位

猎物峰值约4.5，捕食者峰值约2.0

振幅由初始条件决定]
```

**相互作用机制：**
```
[相位差约90°（猎物领先捕食者）

猎物增长促进捕食者增长，过度捕食导致双方下降]
```

**生态平衡：**
```
[系统存在稳定极限环

平衡点(x, y) = (δ/γ, α/β) = (4, 2)

系统对初始条件敏感但保持稳定振荡]
```

### 5.2 数值方法评估

**精度比较：**
```
[RK4精度最高（四阶收敛）

欧拉法因截断误差导致振幅衰减

改进欧拉法平衡精度与效率]
```

**计算效率：**
```
[欧拉法：最快（每步1次函数求值）

改进欧拉法：中等（每步2次求值）

RK4：最慢（每步4次求值）]
```

**适用性分析：**
```
[短期模拟：欧拉法

一般精度：改进欧拉法

高精度需求：RK4

保守系统：RK4（保持能量守恒）]
```

## 6. 思考题

请回答以下思考题：

### 6.1 周期性分析
**问题：** 为什么Lotka-Volterra系统会表现出周期性行为？这种周期性在现实生态系统中是否存在？

**回答：**
```
[周期性成因：

非线性耦合：捕食率项βxy创造正反馈

时滞效应：捕食者响应滞后于猎物变化

密度依赖：种群增长受对方数量制约

现实存在性：

实验室环境：观察到周期性（如草履虫-栉毛虫系统）

自然生态系统：受多因素干扰，周期性不完美但存在（如雪兔-猞猁的9-10年周期）]
```



**实验报告完成情况自评：**

- [✔] 完成了所有必需的函数实现
- [✔ ] 通过了所有测试用例
- [ ✔] 生成了所有要求的图表
- [ ✔] 完成了结果分析和讨论
- [✔ ] 回答了所有思考题

**总体评价：** [本实验完整实现了Lotka-Volterra模型的数值求解和系统分析，通过三种数值方法的比较揭示了算法特性，深入探讨了模型的生物学意义和局限性。]

**建议成绩：** [95] / 100分
